---
import Layout from '../layouts/Layout.astro';
import { initSudokuGame } from '../js/sudoku.js';
---
<Layout title="Sudoku | VARN Gaming">
  <button class="back-btn mb-6 text-gray-400 hover:text-white transition-colors" onclick="history.back()">Back to Games</button>
  <div class="bg-gray-800 rounded-xl shadow-xl border border-gray-700 p-8 flex flex-col items-center">
      <h2 class="text-3xl font-bold text-white mb-6">Sudoku Puzzle</h2>
      <div class="text-white mb-4">
          <div class="flex flex-col sm:flex-row items-center justify-center gap-4">
              <label for="toggleCandidates" class="text-gray-400">Show candidates</label>
              <input id="toggleCandidates" class="js-candidate-toggle" type="checkbox"/>
          </div>
          <div class="mt-4 flex flex-col sm:flex-row items-center justify-center gap-4">
              <span class="text-gray-400">New:</span>
              <div class="game-buttons flex flex-wrap justify-center gap-2">
                  <button type="button" class="sudokubutton bg-green-500 hover:bg-green-600 px-4 py-2 rounded-full" data-difficulty="easy">Easy</button>
                  <button type="button" class="sudokubutton bg-yellow-500 hover:bg-yellow-600 px-4 py-2 rounded-full" data-difficulty="medium">Medium</button>
                  <button type="button" class="sudokubutton bg-orange-500 hover:bg-orange-600 px-4 py-2 rounded-full" data-difficulty="hard">Hard</button>
                  <button type="button" class="sudokubutton bg-red-600 hover:bg-red-700 px-4 py-2 rounded-full" data-difficulty="very-hard">Very Hard</button>
              </div>
          </div>
          <div class="mt-4 flex flex-col sm:flex-row items-center justify-center gap-4">
              <span class="text-gray-400">Solve:</span>
              <div class="game-buttons flex flex-wrap justify-center gap-2">
                  <button type="button" class="sudokubutton bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded-full" data-action="solveStep">One Step</button>
                  <button type="button" class="sudokubutton bg-indigo-600 hover:bg-indigo-700 px-4 py-2 rounded-full" data-action="solveAll">All</button>
              </div>
          </div>
          <div class="mt-4 flex flex-col sm:flex-row items-center justify-center gap-4">
              <span class="text-gray-400">Clear:</span>
              <div class="game-buttons flex flex-wrap justify-center gap-2">
                  <button type="button" class="sudokubutton bg-gray-500 hover:bg-gray-600 px-4 py-2 rounded-full" data-action="clearBoard">Board</button>
              </div>
          </div>
      </div>
      <div id="sudoku-container" class="w-full max-w-sm sm:max-w-md">
          <div id="sudoku" class="sudoku-board"></div>
      </div>
  </div>
</Layout>

<script>
    import { initSudokuGame } from '../js/sudoku.js';

    document.addEventListener('DOMContentLoaded', () => {
        const sudokuGame = initSudokuGame('sudoku');
        sudokuGame.generateBoard('easy');

        document.querySelectorAll('.sudokubutton').forEach(button => {
            button.addEventListener('click', (e) => {
                if (!e.target || !(e.target instanceof HTMLElement)) {
                    return;
                }
                const target = e.target;
                const difficulty = target.dataset.difficulty;
                const action = target.dataset.action;
                if (difficulty) {
                    sudokuGame.generateBoard(difficulty);
                } else if (action === 'solveAll') {
                    sudokuGame.solveAll();
                } else if (action === 'solveStep') {
                    sudokuGame.solveStep();
                } else if (action === 'clearBoard') {
                    sudokuGame.clearBoard();
                }
            });
        });
    });
</script>
